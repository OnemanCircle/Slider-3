name: Rename Images

on:
  workflow_dispatch:  # Manually triggered

jobs:
  rename:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Rename images in each subsection
        run: |
          find images -type d -mindepth 2 | while read dir; do
            echo "Processing folder: $dir"
            cd "$dir"

            jpg_files=(*.jpg)
            if [ -e "${jpg_files[0]}" ]; then
              count=1
              for img in $(ls *.jpg | sort); do
                newname="${count}.jpg"
                mv -f "$img" "$newname"
                count=$((count + 1))
              done
            else
              echo "No .jpg images found in $dir"
            fi

            cd - > /dev/null
          done

      - name: Commit renamed images
        run: |
          git config --global user.name 'GitHub Actions'
          git config --global user.email 'actions@github.com'
          git add images/
          git commit -m 'Freshly renamed images in each subsection'
          git push https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/OnemanCircle/Slider-3.git HEAD:main || echo "No changes to commit"
